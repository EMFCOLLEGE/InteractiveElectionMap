import { jsx as _jsx, jsxs as _jsxs } from "preact/jsx-runtime";
import { useState, useRef, useEffect } from 'preact/hooks';
function getMenuItemValue(item) {
    return typeof item === 'string' ? item : item.value;
}
function getMenuItemLabel(item) {
    return typeof item === 'string' ? item : item.label;
}
function getMenuItemIcon(item) {
    return typeof item === 'string' ? undefined : item.icon;
}
export const DropdownMenu = (props) => {
    const [isOpen, setIsOpen] = useState(false);
    const dropdownRef = useRef(null);
    const toggleDropdown = () => setIsOpen(!isOpen);
    const handleClickOutside = (event) => {
        if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {
            setIsOpen(false);
        }
    };
    useEffect(() => {
        document.addEventListener('mousedown', handleClickOutside);
        return () => {
            document.removeEventListener('mousedown', handleClickOutside);
        };
    }, []);
    const handleSelect = (item) => {
        props.onSelect(getMenuItemValue(item));
        setIsOpen(false);
    };
    // Don't render anything if there are no menu items
    if (props.menuItems.length === 0) {
        return null;
    }
    return (_jsxs("div", { className: "deck-widget-dropdown-container", ref: dropdownRef, style: props.style, children: [_jsx("button", { className: "deck-widget-dropdown-button", onClick: toggleDropdown, children: _jsx("span", { className: `deck-widget-dropdown-icon ${isOpen ? 'open' : ''}` }) }), isOpen && (_jsx("ul", { className: "deck-widget-dropdown-menu", children: props.menuItems.map(item => {
                    const icon = getMenuItemIcon(item);
                    return (_jsxs("li", { className: "deck-widget-dropdown-item", onClick: () => handleSelect(item), children: [icon && (_jsx("span", { className: "deck-widget-dropdown-item-icon", style: { maskImage: `url("${icon}")`, WebkitMaskImage: `url("${icon}")` } })), getMenuItemLabel(item)] }, getMenuItemValue(item)));
                }) }))] }));
};
//# sourceMappingURL=dropdown-menu.js.map