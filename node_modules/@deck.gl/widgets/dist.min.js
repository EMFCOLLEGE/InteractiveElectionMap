(function webpackUniversalModuleDefinition(root, factory) {
  if (typeof exports === 'object' && typeof module === 'object')
    module.exports = factory();
  else if (typeof define === 'function' && define.amd) define([], factory);
        else if (typeof exports === 'object') exports['deck'] = factory();
  else root['deck'] = factory();})(globalThis, function () {
"use strict";var __exports__=(()=>{var jt=Object.create;var _e=Object.defineProperty;var Qt=Object.getOwnPropertyDescriptor;var eo=Object.getOwnPropertyNames;var to=Object.getPrototypeOf,oo=Object.prototype.hasOwnProperty;var ht=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports),io=(t,o)=>{for(var e in o)_e(t,e,{get:o[e],enumerable:!0})},fe=(t,o,e,i)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of eo(o))!oo.call(t,n)&&n!==e&&_e(t,n,{get:()=>o[n],enumerable:!(i=Qt(o,n))||i.enumerable});return t},V=(t,o,e)=>(fe(t,o,"default"),e&&fe(e,o,"default")),y=(t,o,e)=>(e=t!=null?jt(to(t)):{},fe(o||!t||!t.__esModule?_e(e,"default",{value:t,enumerable:!0}):e,t)),no=t=>fe(_e({},"__esModule",{value:!0}),t);var x=ht(($o,gt)=>{gt.exports=globalThis.deck});var Jt=ht((Cn,Xt)=>{Xt.exports=globalThis.luma});var me={};io(me,{CompassWidget:()=>Y,DarkGlassTheme:()=>Ne,DarkTheme:()=>zt,FullscreenWidget:()=>te,GimbalWidget:()=>K,LightGlassTheme:()=>Re,LightTheme:()=>Bt,ResetViewWidget:()=>J,ScreenshotWidget:()=>le,ZoomWidget:()=>X,_ButtonGroup:()=>q,_ContextMenuWidget:()=>se,_CoordinatesGeocoder:()=>B,_CurrentLocationGeocoder:()=>Le,_DropdownMenu:()=>Me,_FpsWidget:()=>pe,_GeocoderWidget:()=>ee,_GoogleGeocoder:()=>We,_GroupedIconButton:()=>O,_IconButton:()=>M,_IconMenu:()=>He,_InfoWidget:()=>re,_LoadingWidget:()=>ce,_MapboxGeocoder:()=>Se,_OpenCageGeocoder:()=>Ce,_ScaleWidget:()=>j,_SimpleMenu:()=>Ve,_SplitterWidget:()=>ie,_StatsWidget:()=>ue,_ThemeWidget:()=>de,_TimelineWidget:()=>ae,_ViewSelectorWidget:()=>ne});var L={},ft=y(x(),1);V(L,y(x(),1));if(!ft.Layer)throw new Error("@deck.gl/core is not found");V(me,L);var F=y(x(),1);var xe,b,yt,ro,G,_t,xt,De,Ae,Oe,Fe,so,z={},Pt=[],ao=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ue=Array.isArray;function R(t,o){for(var e in o)t[e]=o[e];return t}function kt(t){var o=t.parentNode;o&&o.removeChild(t)}function lo(t,o,e){var i,n,r,d={};for(r in o)r=="key"?i=o[r]:r=="ref"?n=o[r]:d[r]=o[r];if(arguments.length>2&&(d.children=arguments.length>3?xe.call(arguments,2):e),typeof t=="function"&&t.defaultProps!=null)for(r in t.defaultProps)d[r]===void 0&&(d[r]=t.defaultProps[r]);return we(t,d,i,n,null)}function we(t,o,e,i,n){var r={type:t,props:o,key:e,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:n??++yt,__i:-1,__u:0};return n==null&&b.vnode!=null&&b.vnode(r),r}function U(t){return t.children}function be(t,o){this.props=t,this.context=o}function D(t,o){if(o==null)return t.__?D(t.__,t.__i+1):null;for(var e;o<t.__k.length;o++)if((e=t.__k[o])!=null&&e.__e!=null)return e.__e;return typeof t.type=="function"?D(t):null}function It(t){var o,e;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,o=0;o<t.__k.length;o++)if((e=t.__k[o])!=null&&e.__e!=null){t.__e=t.__c.base=e.__e;break}return It(t)}}function vt(t){(!t.__d&&(t.__d=!0)&&G.push(t)&&!ye.__r++||_t!==b.debounceRendering)&&((_t=b.debounceRendering)||xt)(ye)}function ye(){var t,o,e,i,n,r,d,a;for(G.sort(De);t=G.shift();)t.__d&&(o=G.length,i=void 0,r=(n=(e=t).__v).__e,d=[],a=[],e.__P&&((i=R({},n)).__v=n.__v+1,b.vnode&&b.vnode(i),qe(e.__P,i,n,e.__n,e.__P.namespaceURI,32&n.__u?[r]:null,d,r??D(n),!!(32&n.__u),a),i.__v=n.__v,i.__.__k[i.__i]=i,Wt(d,i,a),i.__e!=r&&It(i)),G.length>o&&G.sort(De));ye.__r=0}function Mt(t,o,e,i,n,r,d,a,p,c,u){var s,h,m,_,I,g=i&&i.__k||Pt,v=o.length;for(e.__d=p,co(e,o,g),p=e.__d,s=0;s<v;s++)(m=e.__k[s])!=null&&typeof m!="boolean"&&typeof m!="function"&&(h=m.__i===-1?z:g[m.__i]||z,m.__i=s,qe(t,m,h,n,r,d,a,p,c,u),_=m.__e,m.ref&&h.ref!=m.ref&&(h.ref&&Be(h.ref,null,m),u.push(m.ref,m.__c||_,m)),I==null&&_!=null&&(I=_),65536&m.__u||h.__k===m.__k?p=Tt(m,p,t):typeof m.type=="function"&&m.__d!==void 0?p=m.__d:_&&(p=_.nextSibling),m.__d=void 0,m.__u&=-196609);e.__d=p,e.__e=I}function co(t,o,e){var i,n,r,d,a,p=o.length,c=e.length,u=c,s=0;for(t.__k=[],i=0;i<p;i++)d=i+s,(n=t.__k[i]=(n=o[i])==null||typeof n=="boolean"||typeof n=="function"?null:typeof n=="string"||typeof n=="number"||typeof n=="bigint"||n.constructor==String?we(null,n,null,null,null):Ue(n)?we(U,{children:n},null,null,null):n.constructor===void 0&&n.__b>0?we(n.type,n.props,n.key,n.ref?n.ref:null,n.__v):n)!=null?(n.__=t,n.__b=t.__b+1,a=po(n,e,d,u),n.__i=a,r=null,a!==-1&&(u--,(r=e[a])&&(r.__u|=131072)),r==null||r.__v===null?(a==-1&&s--,typeof n.type!="function"&&(n.__u|=65536)):a!==d&&(a==d-1?s--:a==d+1?s++:a>d?u>p-d?s+=a-d:s--:a<d&&(a==d-s?s-=a-d:s++),a!==i+s&&(n.__u|=65536))):(r=e[d])&&r.key==null&&r.__e&&!(131072&r.__u)&&(r.__e==t.__d&&(t.__d=D(r)),$e(r,r,!1),e[d]=null,u--);if(u)for(i=0;i<c;i++)(r=e[i])!=null&&!(131072&r.__u)&&(r.__e==t.__d&&(t.__d=D(r)),$e(r,r))}function Tt(t,o,e){var i,n;if(typeof t.type=="function"){for(i=t.__k,n=0;i&&n<i.length;n++)i[n]&&(i[n].__=t,o=Tt(i[n],o,e));return o}t.__e!=o&&(o&&t.type&&!e.contains(o)&&(o=D(t)),e.insertBefore(t.__e,o||null),o=t.__e);do o=o&&o.nextSibling;while(o!=null&&o.nodeType===8);return o}function po(t,o,e,i){var n=t.key,r=t.type,d=e-1,a=e+1,p=o[e];if(p===null||p&&n==p.key&&r===p.type&&!(131072&p.__u))return e;if(i>(p!=null&&!(131072&p.__u)?1:0))for(;d>=0||a<o.length;){if(d>=0){if((p=o[d])&&!(131072&p.__u)&&n==p.key&&r===p.type)return d;d--}if(a<o.length){if((p=o[a])&&!(131072&p.__u)&&n==p.key&&r===p.type)return a;a++}}return-1}function wt(t,o,e){o[0]==="-"?t.setProperty(o,e??""):t[o]=e==null?"":typeof e!="number"||ao.test(o)?e:e+"px"}function ve(t,o,e,i,n){var r;e:if(o==="style")if(typeof e=="string")t.style.cssText=e;else{if(typeof i=="string"&&(t.style.cssText=i=""),i)for(o in i)e&&o in e||wt(t.style,o,"");if(e)for(o in e)i&&e[o]===i[o]||wt(t.style,o,e[o])}else if(o[0]==="o"&&o[1]==="n")r=o!==(o=o.replace(/(PointerCapture)$|Capture$/i,"$1")),o=o.toLowerCase()in t||o==="onFocusOut"||o==="onFocusIn"?o.toLowerCase().slice(2):o.slice(2),t.l||(t.l={}),t.l[o+r]=e,e?i?e.u=i.u:(e.u=Ae,t.addEventListener(o,r?Fe:Oe,r)):t.removeEventListener(o,r?Fe:Oe,r);else{if(n=="http://www.w3.org/2000/svg")o=o.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(o!="width"&&o!="height"&&o!="href"&&o!="list"&&o!="form"&&o!="tabIndex"&&o!="download"&&o!="rowSpan"&&o!="colSpan"&&o!="role"&&o!="popover"&&o in t)try{t[o]=e??"";break e}catch{}typeof e=="function"||(e==null||e===!1&&o[4]!=="-"?t.removeAttribute(o):t.setAttribute(o,o=="popover"&&e==1?"":e))}}function bt(t){return function(o){if(this.l){var e=this.l[o.type+t];if(o.t==null)o.t=Ae++;else if(o.t<e.u)return;return e(b.event?b.event(o):o)}}}function qe(t,o,e,i,n,r,d,a,p,c){var u,s,h,m,_,I,g,v,w,H,T,W,S,mt,he,Ge,C=o.type;if(o.constructor!==void 0)return null;128&e.__u&&(p=!!(32&e.__u),r=[a=o.__e=e.__e]),(u=b.__b)&&u(o);e:if(typeof C=="function")try{if(v=o.props,w="prototype"in C&&C.prototype.render,H=(u=C.contextType)&&i[u.__c],T=u?H?H.props.value:u.__:i,e.__c?g=(s=o.__c=e.__c).__=s.__E:(w?o.__c=s=new C(v,T):(o.__c=s=new be(v,T),s.constructor=C,s.render=mo),H&&H.sub(s),s.props=v,s.state||(s.state={}),s.context=T,s.__n=i,h=s.__d=!0,s.__h=[],s._sb=[]),w&&s.__s==null&&(s.__s=s.state),w&&C.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=R({},s.__s)),R(s.__s,C.getDerivedStateFromProps(v,s.__s))),m=s.props,_=s.state,s.__v=o,h)w&&C.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),w&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(w&&C.getDerivedStateFromProps==null&&v!==m&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(v,T),!s.__e&&(s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(v,s.__s,T)===!1||o.__v===e.__v)){for(o.__v!==e.__v&&(s.props=v,s.state=s.__s,s.__d=!1),o.__e=e.__e,o.__k=e.__k,o.__k.forEach(function(ge){ge&&(ge.__=o)}),W=0;W<s._sb.length;W++)s.__h.push(s._sb[W]);s._sb=[],s.__h.length&&d.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(v,s.__s,T),w&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(m,_,I)})}if(s.context=T,s.props=v,s.__P=t,s.__e=!1,S=b.__r,mt=0,w){for(s.state=s.__s,s.__d=!1,S&&S(o),u=s.render(s.props,s.state,s.context),he=0;he<s._sb.length;he++)s.__h.push(s._sb[he]);s._sb=[]}else do s.__d=!1,S&&S(o),u=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++mt<25);s.state=s.__s,s.getChildContext!=null&&(i=R(R({},i),s.getChildContext())),w&&!h&&s.getSnapshotBeforeUpdate!=null&&(I=s.getSnapshotBeforeUpdate(m,_)),Mt(t,Ue(Ge=u!=null&&u.type===U&&u.key==null?u.props.children:u)?Ge:[Ge],o,e,i,n,r,d,a,p,c),s.base=o.__e,o.__u&=-161,s.__h.length&&d.push(s),g&&(s.__E=s.__=null)}catch(ge){if(o.__v=null,p||r!=null){for(o.__u|=p?160:32;a&&a.nodeType===8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,o.__e=a}else o.__e=e.__e,o.__k=e.__k;b.__e(ge,o,e)}else r==null&&o.__v===e.__v?(o.__k=e.__k,o.__e=e.__e):o.__e=uo(e.__e,o,e,i,n,r,d,p,c);(u=b.diffed)&&u(o)}function Wt(t,o,e){o.__d=void 0;for(var i=0;i<e.length;i++)Be(e[i],e[++i],e[++i]);b.__c&&b.__c(o,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(r){r.call(n)})}catch(r){b.__e(r,n.__v)}})}function uo(t,o,e,i,n,r,d,a,p){var c,u,s,h,m,_,I,g=e.props,v=o.props,w=o.type;if(w==="svg"?n="http://www.w3.org/2000/svg":w==="math"?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),r!=null){for(c=0;c<r.length;c++)if((m=r[c])&&"setAttribute"in m==!!w&&(w?m.localName===w:m.nodeType===3)){t=m,r[c]=null;break}}if(t==null){if(w===null)return document.createTextNode(v);t=document.createElementNS(n,w,v.is&&v),r=null,a=!1}if(w===null)g===v||a&&t.data===v||(t.data=v);else{if(r=r&&xe.call(t.childNodes),g=e.props||z,!a&&r!=null)for(g={},c=0;c<t.attributes.length;c++)g[(m=t.attributes[c]).name]=m.value;for(c in g)if(m=g[c],c!="children"){if(c=="dangerouslySetInnerHTML")s=m;else if(c!=="key"&&!(c in v)){if(c=="value"&&"defaultValue"in v||c=="checked"&&"defaultChecked"in v)continue;ve(t,c,null,m,n)}}for(c in v)m=v[c],c=="children"?h=m:c=="dangerouslySetInnerHTML"?u=m:c=="value"?_=m:c=="checked"?I=m:c==="key"||a&&typeof m!="function"||g[c]===m||ve(t,c,m,g[c],n);if(u)a||s&&(u.__html===s.__html||u.__html===t.innerHTML)||(t.innerHTML=u.__html),o.__k=[];else if(s&&(t.innerHTML=""),Mt(t,Ue(h)?h:[h],o,e,i,w==="foreignObject"?"http://www.w3.org/1999/xhtml":n,r,d,r?r[0]:e.__k&&D(e,0),a,p),r!=null)for(c=r.length;c--;)r[c]!=null&&kt(r[c]);a||(c="value",_!==void 0&&(_!==t[c]||w==="progress"&&!_||w==="option"&&_!==g[c])&&ve(t,c,_,g[c],n),c="checked",I!==void 0&&I!==t[c]&&ve(t,c,I,g[c],n))}return t}function Be(t,o,e){try{if(typeof t=="function"){var i=typeof t.__u=="function";i&&t.__u(),i&&o==null||(t.__u=t(o))}else t.current=o}catch(n){b.__e(n,e)}}function $e(t,o,e){var i,n;if(b.unmount&&b.unmount(t),(i=t.ref)&&(i.current&&i.current!==t.__e||Be(i,null,o)),(i=t.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(r){b.__e(r,o)}i.base=i.__P=null}if(i=t.__k)for(n=0;n<i.length;n++)i[n]&&$e(i[n],o,e||typeof t.type!="function");e||t.__e==null||kt(t.__e),t.__c=t.__=t.__e=t.__d=void 0}function mo(t,o,e){return this.constructor(t,e)}function f(t,o,e){var i,n,r,d;b.__&&b.__(t,o),n=(i=typeof e=="function")?null:e&&e.__k||o.__k,r=[],d=[],qe(o,t=(!i&&e||o).__k=lo(U,null,[t]),n||z,z,o.namespaceURI,!i&&e?[e]:n?null:o.firstChild?xe.call(o.childNodes):null,r,!i&&e?e:n?n.__e:o.firstChild,i,d),Wt(r,t,d)}xe=Pt.slice,b={__e:function(t,o,e,i){for(var n,r,d;o=o.__;)if((n=o.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(t)),d=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(t,i||{}),d=n.__d),d)return n.__E=n}catch(a){t=a}throw t}},yt=0,ro=function(t){return t!=null&&t.constructor==null},be.prototype.setState=function(t,o){var e;e=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=R({},this.state),typeof t=="function"&&(t=t(R({},e),this.props)),t&&R(e,t),t!=null&&this.__v&&(o&&this._sb.push(o),vt(this))},be.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),vt(this))},be.prototype.render=U,G=[],xt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,De=function(t,o){return t.__v.__b-o.__v.__b},ye.__r=0,Ae=0,Oe=bt(!1),Fe=bt(!0),so=0;var ho=0,Bo=Array.isArray;function l(t,o,e,i,n,r){o||(o={});var d,a,p=o;if("ref"in p)for(a in p={},o)a=="ref"?d=o[a]:p[a]=o[a];var c={type:t,props:p,key:e,ref:d,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--ho,__i:-1,__u:0,__source:n,__self:r};if(typeof t=="function"&&(d=t.defaultProps))for(a in d)p[a]===void 0&&(p[a]=d[a]);return b.vnode&&b.vnode(c),c}var q=t=>{let{children:o,orientation:e="horizontal"}=t;return l("div",{className:`deck-widget-button-group ${e}`,children:o})};var O=t=>{let{className:o="",label:e,onClick:i,children:n}=t;return l("button",{className:`deck-widget-icon-button ${o}`,type:"button",onClick:i,title:e,children:n||l("div",{className:"deck-widget-icon"})})};var X=class extends F.Widget{constructor(e={}){super(e);this.className="deck-widget-zoom";this.placement="top-left";this.viewports={};this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){let i=l(q,{orientation:this.props.orientation,children:[l(O,{onClick:()=>this.handleZoomIn(),label:this.props.zoomInLabel,className:"deck-widget-zoom-in"}),l(O,{onClick:()=>this.handleZoomOut(),label:this.props.zoomOutLabel,className:"deck-widget-zoom-out"})]});f(i,e)}onViewportChange(e){this.viewports[e.id]=e}handleZoom(e,i){let n=this.viewId||e?.id||"default-view",r={...e,zoom:i};this.props.transitionDuration>0&&(r.transitionDuration=this.props.transitionDuration,r.transitionInterpolator="latitude"in r?new F.FlyToInterpolator:new F.LinearInterpolator({transitionProps:["zoom"]})),this.setViewState(n,r)}handleZoomIn(){for(let e of Object.values(this.viewports))this.handleZoom(e,e.zoom+1)}handleZoomOut(){for(let e of Object.values(this.viewports))this.handleZoom(e,e.zoom-1)}setViewState(e,i){this.deck._onViewStateChange({viewId:e,viewState:i,interactionState:{}})}};X.defaultProps={...F.Widget.defaultProps,id:"zoom",placement:"top-left",orientation:"vertical",transitionDuration:200,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",viewId:null};var ze=y(x(),1);var M=t=>{let{className:o="",label:e,onClick:i,children:n}=t;return l("div",{className:"deck-widget-button",children:l("button",{className:`deck-widget-icon-button ${o}`,type:"button",onClick:i,title:e,children:n||l("div",{className:"deck-widget-icon"})})})};var J=class extends ze.Widget{constructor(e={}){super(e);this.className="deck-widget-reset-view";this.placement="top-left";this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){f(l(M,{className:"deck-widget-reset-focus",label:this.props.label,onClick:this.handleClick.bind(this)}),e)}handleClick(){let e=this.props.initialViewState||this.deck?.props.initialViewState;this.setViewState(e)}setViewState(e){let i=this.props.viewId||"default-view",n={...i!=="default-view"?e?.[i]:e};this.deck._onViewStateChange({viewId:i,viewState:n,interactionState:{}})}};J.defaultProps={...ze.Widget.defaultProps,id:"reset-view",placement:"top-left",label:"Reset View",initialViewState:void 0,viewId:null};var Z=y(x(),1);var K=class extends Z.Widget{constructor(e={}){super(e);this.className="deck-widget-gimbal";this.placement="top-left";this.viewports={};this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){let i=this.viewId||Object.values(this.viewports)[0]?.id||"default-view",n=this.viewports[i],{rotationOrbit:r,rotationX:d}=this.getNormalizedRotation(n),a=l("div",{className:"deck-widget-button",style:{perspective:100,pointerEvents:"auto"},children:l("button",{type:"button",onClick:()=>{for(let p of Object.values(this.viewports))this.resetOrbitView(p)},title:this.props.label,style:{position:"relative",width:26,height:26},children:[l("svg",{className:"gimbal-outer-ring",width:"100%",height:"100%",viewBox:"0 0 26 26",style:{position:"absolute",top:0,left:0,transform:`rotateY(${r}deg)`},children:l("circle",{cx:"13",cy:"13",r:"10",stroke:"var(--icon-gimbal-outer-color, rgb(68, 92, 204))",strokeWidth:this.props.strokeWidth,fill:"none"})}),l("svg",{className:"gimbal-inner-ring",width:"100%",height:"100%",viewBox:"0 0 26 26",style:{position:"absolute",top:0,left:0,transform:`rotateX(${d}deg)`},children:l("circle",{cx:"13",cy:"13",r:"7",stroke:"var(--icon-gimbal-inner-color, rgb(240, 92, 68))",strokeWidth:this.props.strokeWidth,fill:"none"})})]})});f(a,e)}onViewportChange(e){this.viewports[e.id]=e,this.updateHTML()}resetOrbitView(e){let i=this.getViewId(e),n=this.getViewState(i);if("rotationOrbit"in n||"rotationX"in n){let r={...n,rotationOrbit:0,rotationX:0,transitionDuration:this.props.transitionDuration,transitionInterpolator:new Z.LinearInterpolator({transitionProps:["rotationOrbit","rotationX"]})};this.deck._onViewStateChange({viewId:i,viewState:r,interactionState:{}})}}getNormalizedRotation(e){let i=this.getViewState(this.getViewId(e)),[n,r]=this.getRotation(i),d=St(n),a=St(r);return{rotationOrbit:d,rotationX:a}}getRotation(e){return e&&("rotationOrbit"in e||"rotationX"in e)?[-(e.rotationOrbit||0),e.rotationX||0]:[0,0]}getViewId(e){return this.viewId||e?.id||"OrbitView"}getViewState(e){let i=this.getViewManager();return e&&i.getViewState(e)||i.viewState}getViewManager(){let e=this.deck?.viewManager;if(!e)throw new Error("wigdet must be added to a deck instance");return e}};K.defaultProps={...Z.Widget.defaultProps,id:"gimbal",placement:"top-left",viewId:null,label:"Gimbal",strokeWidth:1.5,transitionDuration:200};function St(t){let o=((t+180)%360+360)%360-180,e=10,i=o-90;return Math.abs(i)<e&&(i<e?o=90+e:i>-e&&(o=90-e)),o}var E=y(x(),1);var Y=class extends E.Widget{constructor(e={}){super(e);this.className="deck-widget-compass";this.placement="top-left";this.viewports={};this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){let i=this.viewId||Object.values(this.viewports)[0]?.id||"default-view",n=this.viewports[i],[r,d]=this.getRotation(n),a=l("div",{className:"deck-widget-button",style:{perspective:100},children:l("button",{type:"button",onClick:()=>{for(let p of Object.values(this.viewports))this.handleCompassReset(p)},title:this.props.label,style:{transform:`rotateX(${d}deg)`},children:l("svg",{fill:"none",width:"100%",height:"100%",viewBox:"0 0 26 26",children:l("g",{transform:`rotate(${r},13,13)`,children:[l("path",{d:"M10 13.0001L12.9999 5L15.9997 13.0001H10Z",fill:"var(--icon-compass-north-color, rgb(240, 92, 68))"}),l("path",{d:"M16.0002 12.9999L13.0004 21L10.0005 12.9999H16.0002Z",fill:"var(--icon-compass-south-color, rgb(204, 204, 204))"})]})})})});f(a,e)}onViewportChange(e){e.equals(this.viewports[e.id])||(this.viewports[e.id]=e,this.updateHTML())}getRotation(e){return e instanceof E.WebMercatorViewport?[-e.bearing,e.pitch]:e instanceof E._GlobeViewport?[0,Math.max(-80,Math.min(80,e.latitude))]:[0,0]}handleCompassReset(e){let i=this.viewId||e.id||"default-view";if(e instanceof E.WebMercatorViewport){let n={...e,bearing:0,...this.getRotation(e)[0]===0?{pitch:0}:{},transitionDuration:this.props.transitionDuration,transitionInterpolator:new E.FlyToInterpolator};this.deck._onViewStateChange({viewId:i,viewState:n,interactionState:{}})}}};Y.defaultProps={...E.Widget.defaultProps,id:"compass",placement:"top-left",viewId:null,label:"Reset Compass",transitionDuration:200};var Xe=y(x(),1);var j=class extends Xe.Widget{constructor(e={}){super(e);this.className="deck-widget-scale";this.placement="bottom-left";this.scaleWidth=10;this.scaleValue=0;this.scaleText="";this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){let n=50+this.scaleWidth,r=10;f(l("svg",{className:"deck-widget-scale",width:n,height:30,style:{overflow:"visible",background:"transparent"},onClick:this.handleClick.bind(this),children:[l("text",{x:50+5,y:"10",textAnchor:"end",alignmentBaseline:"middle",style:{fontSize:"16px",fill:"black",fontWeight:"bold",fontFamily:"sans-serif"},children:this.scaleText}),l("line",{x1:50,y1:"15",x2:50+this.scaleWidth,y2:"15",stroke:"black",strokeWidth:"6"}),l("line",{x1:50,y1:"15",x2:50,y2:15-r,stroke:"black",strokeWidth:"6"}),l("line",{x1:50+this.scaleWidth,y1:"15",x2:50+this.scaleWidth,y2:15-r,stroke:"black",strokeWidth:"6"})]}),e)}onViewportChange(e){if(!("latitude"in e))return;let{latitude:i,zoom:n}=e,r=go(i,n),{candidate:d,candidatePixels:a}=fo(r);this.scaleValue=d,this.scaleWidth=a,d>=1e3?this.scaleText=`${(d/1e3).toFixed(1)} km`:this.scaleText=`${d} m`,this.updateHTML()}handleClick(){}};j.defaultProps={...Xe.Widget.defaultProps,id:"scale",placement:"bottom-left",label:"Scale",viewId:null};function go(t,o){return 40075016686e-3*Math.cos(t*Math.PI/180)/Math.pow(2,o+8)}function fo(t){let n=150*t,r=Math.floor(Math.log10(n)),d=Math.pow(10,r),a=[1,2,5],p=a[0]*d,c=p/t;for(let u=0;u<a.length;u++){let s=a[u]*d,h=s/t;if(h>=100&&h<=200){p=s,c=h;break}if(h>200){p=u>0?a[u-1]*d:s,c=p/t;break}u===a.length-1&&h<100&&(p=a[0]*d*10,c=p/t)}return{candidate:p,candidatePixels:c}}var je=y(x(),1),Ee=y(x(),1);var Q,P,Je,Ct,ke=0,Dt=[],k=b,Lt=k.__b,Et=k.__r,Ht=k.diffed,Vt=k.__c,Rt=k.unmount,Nt=k.__;function Ze(t,o){k.__h&&k.__h(P,t,ke||o),ke=0;var e=P.__H||(P.__H={__:[],__h:[]});return t>=e.__.length&&e.__.push({}),e.__[t]}function $(t){return ke=1,_o(Ft,t)}function _o(t,o,e){var i=Ze(Q++,2);if(i.t=t,!i.__c&&(i.__=[e?e(o):Ft(void 0,o),function(a){var p=i.__N?i.__N[0]:i.__[0],c=i.t(p,a);p!==c&&(i.__N=[c,i.__[1]],i.__c.setState({}))}],i.__c=P,!P.u)){var n=function(a,p,c){if(!i.__c.__H)return!0;var u=i.__c.__H.__.filter(function(h){return!!h.__c});if(u.every(function(h){return!h.__N}))return!r||r.call(this,a,p,c);var s=!1;return u.forEach(function(h){if(h.__N){var m=h.__[0];h.__=h.__N,h.__N=void 0,m!==h.__[0]&&(s=!0)}}),!(!s&&i.__c.props===a)&&(!r||r.call(this,a,p,c))};P.u=!0;var r=P.shouldComponentUpdate,d=P.componentWillUpdate;P.componentWillUpdate=function(a,p,c){if(this.__e){var u=r;r=void 0,n(a,p,c),r=u}d&&d.call(this,a,p,c)},P.shouldComponentUpdate=n}return i.__N||i.__}function Ie(t,o){var e=Ze(Q++,3);!k.__s&&Ot(e.__H,o)&&(e.__=t,e.i=o,P.__H.__h.push(e))}function A(t){return ke=5,vo(function(){return{current:t}},[])}function vo(t,o){var e=Ze(Q++,7);return Ot(e.__H,o)&&(e.__=t(),e.__H=o,e.__h=t),e.__}function wo(){for(var t;t=Dt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(Pe),t.__H.__h.forEach(Ke),t.__H.__h=[]}catch(o){t.__H.__h=[],k.__e(o,t.__v)}}k.__b=function(t){P=null,Lt&&Lt(t)},k.__=function(t,o){t&&o.__k&&o.__k.__m&&(t.__m=o.__k.__m),Nt&&Nt(t,o)},k.__r=function(t){Et&&Et(t),Q=0;var o=(P=t.__c).__H;o&&(Je===P?(o.__h=[],P.__h=[],o.__.forEach(function(e){e.__N&&(e.__=e.__N),e.i=e.__N=void 0})):(o.__h.forEach(Pe),o.__h.forEach(Ke),o.__h=[],Q=0)),Je=P},k.diffed=function(t){Ht&&Ht(t);var o=t.__c;o&&o.__H&&(o.__H.__h.length&&(Dt.push(o)!==1&&Ct===k.requestAnimationFrame||((Ct=k.requestAnimationFrame)||bo)(wo)),o.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.i=void 0})),Je=P=null},k.__c=function(t,o){o.some(function(e){try{e.__h.forEach(Pe),e.__h=e.__h.filter(function(i){return!i.__||Ke(i)})}catch(i){o.some(function(n){n.__h&&(n.__h=[])}),o=[],k.__e(i,e.__v)}}),Vt&&Vt(t,o)},k.unmount=function(t){Rt&&Rt(t);var o,e=t.__c;e&&e.__H&&(e.__H.__.forEach(function(i){try{Pe(i)}catch(n){o=n}}),e.__H=void 0,o&&k.__e(o,e.__v))};var Gt=typeof requestAnimationFrame=="function";function bo(t){var o,e=function(){clearTimeout(i),Gt&&cancelAnimationFrame(o),setTimeout(t)},i=setTimeout(e,100);Gt&&(o=requestAnimationFrame(e))}function Pe(t){var o=P,e=t.__c;typeof e=="function"&&(t.__c=void 0,e()),P=o}function Ke(t){var o=P;t.__c=t.__(),P=o}function Ot(t,o){return!t||t.length!==o.length||o.some(function(e,i){return e!==t[i]})}function Ft(t,o){return typeof o=="function"?o(t):o}function $t(t){return typeof t=="string"?t:t.value}function yo(t){return typeof t=="string"?t:t.label}function xo(t){return typeof t=="string"?void 0:t.icon}var Me=t=>{let[o,e]=$(!1),i=A(null),n=()=>e(!o),r=a=>{i.current&&!i.current.contains(a.target)&&e(!1)};Ie(()=>(document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}),[]);let d=a=>{t.onSelect($t(a)),e(!1)};return t.menuItems.length===0?null:l("div",{className:"deck-widget-dropdown-container",ref:i,style:t.style,children:[l("button",{className:"deck-widget-dropdown-button",onClick:n,children:l("span",{className:`deck-widget-dropdown-icon ${o?"open":""}`})}),o&&l("ul",{className:"deck-widget-dropdown-menu",children:t.menuItems.map(a=>{let p=xo(a);return l("li",{className:"deck-widget-dropdown-item",onClick:()=>d(a),children:[p&&l("span",{className:"deck-widget-dropdown-item-icon",style:{maskImage:`url("${p}")`,WebkitMaskImage:`url("${p}")`}}),yo(a)]},$t(a))})})]})};var Po="current",At="deck-geocoder-history",Te=class{constructor(o){this.addressText="";this.errorText="";this.addressHistory=[];this.props={maxEntries:5,...o},this.addressHistory=this.loadPreviousAddresses()}async geocode(o,e,i){this.errorText="",this.addressText=e;try{let n=await o.geocode(e,i);if(n)return this.storeAddress(this.addressText),n;this.errorText="Invalid address"}catch(n){this.errorText=`${n.message}`}return null}loadPreviousAddresses(){try{let o=window.localStorage.getItem(At),e=o&&JSON.parse(o);return Array.isArray(e)?e.filter(n=>typeof n=="string"):[]}catch{}return[]}storeAddress(o){let e=o.trim();if(!e||e===Po)return;let i=[e,...this.addressHistory.filter(n=>n!==e)];this.addressHistory=i.slice(0,this.props.maxEntries);try{window.localStorage.setItem(At,JSON.stringify(this.addressHistory))}catch{}}};var ko="https://maps.googleapis.com/maps/api/geocode/json",Io="https://api.mapbox.com/geocoding/v5/mapbox.places",Mo="https://api.opencagedata.com/geocode/v1/json",We={name:"google",requiresApiKey:!0,async geocode(t,o){let e=encodeURIComponent(t),i=await Ye(`${ko}?address=${e}&key=${o}`);switch(i.status){case"OK":let n=i.results.length>0&&i.results[0].geometry.location;return n?{longitude:n.lng,latitude:n.lat}:null;default:throw new Error(`Google Geocoder failed: ${i.status}`)}}},Se={name:"google",requiresApiKey:!0,async geocode(t,o){let e=encodeURIComponent(t),i=await Ye(`${Io}/${e}.json?access_token=${o}`);if(Array.isArray(i.features)&&i.features.length>0){let n=i.features[0].center;if(Array.isArray(n)&&n.length>=2)return{longitude:n[0],latitude:n[1]}}return null}},Ce={name:"opencage",requiresApiKey:!0,async geocode(t,o){let e=encodeURIComponent(t),i=await Ye(`${Mo}?q=${e}&key=${o}`);if(Array.isArray(i.results)&&i.results.length>0){let n=i.results[0].geometry;return{longitude:n.lng,latitude:n.lat}}return null}},Le={name:"current",requiresApiKey:!1,async geocode(){if(!navigator.geolocation)throw new Error("Geolocation not supported");return new Promise((t,o)=>{navigator.geolocation.getCurrentPosition(e=>{let{longitude:i,latitude:n}=e.coords;t({longitude:i,latitude:n})},e=>o(new Error(e.message)))})}};async function Ye(t){let o;try{o=await fetch(t)}catch(i){throw new Error(`CORS error? ${i}. ${t}: `)}if(!o.ok)throw new Error(`${o.statusText}. ${t}: `);let e=await o.json();if(!e)throw new Error(`No data returned. ${t}`);return e}var B={name:"coordinates",requiresApiKey:!1,placeholderLocation:"-122.45, 37.8 or 37\xB048'N, 122\xB027'W",async geocode(t){return To(t)||null}};function To(t){t=t.trim();let o=t.split(/[,;]/).map(n=>n.trim());if(o.length<2)return null;let e=Ut(o[0]),i=Ut(o[1]);return e===null||i===null?null:Math.abs(e)>90&&Math.abs(i)<=90?{longitude:e,latitude:i}:Math.abs(i)>90&&Math.abs(e)<=90?{longitude:i,latitude:e}:{latitude:e,longitude:i}}function Ut(t){if(t=t.trim(),t.includes("\xB0")||t.includes("'")||t.includes('"')){let i=Wo(t);return isNaN(i)?null:i}let o=1;/[SW]/i.test(t)&&(o=-1),t=t.replace(/[NSEW]/gi,"");let e=parseFloat(t);return isNaN(e)?null:o*e}function Wo(t){let o=/(\d+)[°d]\s*(\d+)?['′m]?\s*(\d+(?:\.\d+)?)?[\"″s]?\s*([NSEW])?/i,e=t.match(o);if(!e)return NaN;let i=parseFloat(e[1])||0,n=parseFloat(e[2])||0,r=parseFloat(e[3])||0,d=e[4]||"",a=i+n/60+r/3600;return/[SW]/i.test(d)&&(a=-a),a}var qt="current",So="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 -960 960 960'%3E%3Cpath d='M480-480q33 0 56.5-23.5T560-560q0-33-23.5-56.5T480-640q-33 0-56.5 23.5T400-560q0 33 23.5 56.5T480-480Zm0 294q122-112 181-203.5T720-552q0-109-69.5-178.5T480-800q-101 0-170.5 69.5T240-552q0 71 59 162.5T480-186Zm0 106Q319-217 239.5-334.5T160-552q0-150 96.5-239T480-880q127 0 223.5 89T800-552q0 100-79.5 217.5T480-80Z'/%3E%3C/svg%3E",Co={label:"Current location",value:qt,icon:So},ee=class extends je.Widget{constructor(e={}){super(e);this.className="deck-widget-geocoder";this.placement="top-left";this.geocodeHistory=new Te({});this.addressText="";this.geocoder=B;this.isGettingLocation=!1;this.setInput=e=>{this.addressText=e};this.handleKeyPress=e=>{e.key==="Enter"&&this.handleSubmit()};this.handleSelect=e=>{e===qt?this.getCurrentLocation():(this.setInput(e),this.handleSubmit())};this.handleSubmit=()=>{this.geocode(this.addressText)};this.getCurrentLocation=async()=>{this.isGettingLocation=!0,this.rootElement&&this.updateHTML();try{let e=await Le.geocode();e&&this.setViewState(e)}catch(e){this.geocodeHistory.errorText=e instanceof Error?e.message:"Location error"}finally{this.isGettingLocation=!1,this.rootElement&&this.updateHTML()}};this.geocode=async e=>{let i=await this.geocodeHistory.geocode(this.geocoder,this.addressText,this.props.apiKey);this.rootElement&&this.updateHTML(),i&&this.setViewState(i)};this.viewports={};this.setProps(this.props)}setProps(e){if(this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,this.geocoder=Lo(this.props),this.geocoder.requiresApiKey&&!this.props.apiKey)throw new Error(`API key is required for the ${this.geocoder.name} geocoder`);super.setProps(e)}onRenderHTML(e){let i=this.props._geolocation?[Co,...this.geocodeHistory.addressHistory]:[...this.geocodeHistory.addressHistory];f(l("div",{className:"deck-widget-geocoder",children:[l("input",{className:"deck-widget-geocoder-input",type:"text",placeholder:this.isGettingLocation?"Finding your location...":this.geocoder.placeholderLocation??"Enter address or location",value:this.geocodeHistory.addressText,onInput:n=>this.setInput(n.target?.value||""),onKeyPress:this.handleKeyPress}),l(Me,{menuItems:i,onSelect:this.handleSelect}),this.geocodeHistory.errorText&&l("div",{className:"deck-widget-geocoder-error",children:this.geocodeHistory.errorText})]}),e)}setViewState(e){let i=this.props.viewId||e?.id||"default-view",r={...this.viewports[i]||{},...e};this.props.transitionDuration>0&&(r.transitionDuration=this.props.transitionDuration,r.transitionInterpolator="latitude"in r?new Ee.FlyToInterpolator:new Ee.LinearInterpolator),this.deck._onViewStateChange({viewId:i,viewState:r,interactionState:{}})}onViewportChange(e){this.viewports[e.id]=e}};ee.defaultProps={...je.Widget.defaultProps,id:"geocoder",viewId:null,placement:"top-left",label:"Geocoder",transitionDuration:200,geocoder:"coordinates",customGeocoder:B,apiKey:"",_geolocation:!1};function Lo(t){switch(t.geocoder){case"google":return We;case"mapbox":return Se;case"opencage":return Ce;case"coordinates":return B;case"custom":if(!t.customGeocoder)throw new Error("Custom geocoder is not defined");return t.customGeocoder;default:throw new Error(`Unknown geocoder: ${t.geocoder}`)}}var oe=y(x(),1);var te=class extends oe.Widget{constructor(e={}){super(e);this.className="deck-widget-fullscreen";this.placement="top-left";this.fullscreen=!1;this.setProps(this.props)}onAdd(){document.addEventListener("fullscreenchange",this.onFullscreenChange.bind(this))}onRemove(){document.removeEventListener("fullscreenchange",this.onFullscreenChange.bind(this))}onRenderHTML(e){f(l(M,{onClick:()=>{this.handleClick().catch(i=>oe.log.error(i)())},label:this.fullscreen?this.props.exitLabel:this.props.enterLabel,className:this.fullscreen?"deck-widget-fullscreen-exit":"deck-widget-fullscreen-enter"}),e)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}getContainer(){return this.props.container||this.deck?.getCanvas()?.parentElement}onFullscreenChange(){let e=this.fullscreen,i=document.fullscreenElement===this.getContainer();e!==i&&(this.fullscreen=!this.fullscreen),this.updateHTML()}async handleClick(){this.fullscreen?await this.exitFullscreen():await this.requestFullscreen(),this.updateHTML()}async requestFullscreen(){let e=this.getContainer();e?.requestFullscreen?await e.requestFullscreen({navigationUI:"hide"}):this.togglePseudoFullscreen()}async exitFullscreen(){document.exitFullscreen?await document.exitFullscreen():this.togglePseudoFullscreen()}togglePseudoFullscreen(){this.getContainer()?.classList.toggle("deck-pseudo-fullscreen")}};te.defaultProps={...oe.Widget.defaultProps,id:"fullscreen",placement:"top-left",viewId:null,enterLabel:"Enter Fullscreen",exitLabel:"Exit Fullscreen",container:void 0};var Qe=y(x(),1);var ie=class extends Qe.Widget{constructor(e){super(e);this.className="deck-widget-splitter";this.placement="fill"}setProps(e){super.setProps(e)}onRenderHTML(e){e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.margin="0px",f(l(Eo,{orientation:this.props.orientation,initialSplit:this.props.initialSplit,onChange:this.props.onChange,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd}),e)}};ie.defaultProps={...Qe.Widget.defaultProps,id:"splitter-widget",viewId1:"",viewId2:"",orientation:"vertical",initialSplit:.5,onChange:()=>{},onDragStart:()=>{},onDragEnd:()=>{}};function Eo({orientation:t,initialSplit:o,onChange:e,onDragStart:i,onDragEnd:n}){let[r,d]=$(o),a=A(!1),p=A(null),c=_=>{a.current=!0,i?.(),document.addEventListener("mousemove",u),document.addEventListener("mouseup",s),_.preventDefault()},u=_=>{if(!a.current||!p.current)return;let I=p.current.getBoundingClientRect(),g;t==="vertical"?g=(_.clientX-I.left)/I.width:g=(_.clientY-I.top)/I.height,g=Math.min(Math.max(g,.05),.95),d(g),e?.(g)},s=_=>{a.current&&(a.current=!1,n?.(),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",s))},h=t==="vertical"?{position:"absolute",top:0,bottom:0,left:`${r*100}%`,width:"4px",cursor:"col-resize",background:"#ccc",zIndex:10,pointerEvents:"auto",boxShadow:"inset -1px 0 0 white, inset 1px 0 0 white"}:{position:"absolute",left:0,right:0,top:`${r*100}%`,height:"4px",cursor:"row-resize",background:"#ccc",zIndex:10,pointerEvents:"auto",boxShadow:"inset -1px 0 0 white, inset 1px 0 0 white"};return l("div",{ref:p,style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:l("div",{style:h,onMouseDown:c})})}var ot=y(x(),1);function He(t){let[o,e]=$(!1),i=A(null),n=h=>{i.current&&!i.current.contains(h.target)&&e(!1)};Ie(()=>(document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}),[i]);let[r,d]=$(t.initialItem),a=h=>{d(h),e(!1),t.onItemSelected(h)},p=()=>e(!o),c=t.menuItems.find(h=>h.value===r),u=t.label||c?.label||"",s=t.icon||c?.icon;return l("div",{style:{position:"relative",display:"inline-block"},ref:i,children:[l(M,{className:t.className,label:u,onClick:p,children:s}),o&&l("div",{className:"deck-widget-icon-menu",children:l(q,{orientation:"vertical",children:t.menuItems.map(h=>l(O,{label:h.label,onClick:()=>a(h.value),children:h.icon},h.value))})})]})}var ne=class extends ot.Widget{constructor(e={}){super(e);this.className="deck-widget-view-selector";this.placement="top-left";this.handleSelectMode=e=>{this.viewMode=e,this.updateHTML(),this.props.onViewModeChange(e)};this.viewMode=this.props.initialViewMode,this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){f(l(He,{className:"deck-widget-view-selector",menuItems:Ho.map(i=>({...i,icon:i.icon()})),initialItem:this.props.initialViewMode,onItemSelected:this.handleSelectMode}),e)}};ne.defaultProps={...ot.Widget.defaultProps,id:"view-selector",placement:"top-left",viewId:null,label:"Split View",initialViewMode:"single",onViewModeChange:()=>{}};var et={width:"24px",height:"24px"},tt={single:()=>l("svg",{width:"24",height:"24",style:et,children:l("rect",{x:"4",y:"4",width:"16",height:"16",stroke:"var(--button-icon-hover, rgb(24, 24, 26))",fill:"none",strokeWidth:"2"})}),"split-horizontal":()=>l("svg",{width:"24",height:"24",style:et,children:[l("rect",{x:"4",y:"4",width:"16",height:"7",stroke:"var(--button-icon-hover, rgb(24, 24, 26))",fill:"none",strokeWidth:"2"}),l("rect",{x:"4",y:"13",width:"16",height:"7",stroke:"var(--button-icon-hover, rgb(24, 24, 26))",fill:"none",strokeWidth:"2"})]}),"split-vertical":()=>l("svg",{width:"24",height:"24",style:et,children:[l("rect",{x:"4",y:"4",width:"7",height:"16",stroke:"var(--button-icon-hover, rgb(24, 24, 26))",fill:"none",strokeWidth:"2"}),l("rect",{x:"13",y:"4",width:"7",height:"16",stroke:"var(--button-icon-hover, rgb(24, 24, 26))",fill:"none",strokeWidth:"2"})]})},Ho=[{value:"single",icon:tt.single,label:"Single View"},{value:"split-horizontal",icon:tt["split-horizontal"],label:"Split Horizontal"},{value:"split-vertical",icon:tt["split-vertical"],label:"Split Vertical"}];var it=y(x(),1);var re=class extends it.Widget{constructor(e){super(e);this.className="deck-widget-info";this.placement="fill";this.setProps(this.props)}setProps(e){this.viewId=e.viewId??this.viewId,super.setProps(e)}onCreateRootElement(){let e=super.onCreateRootElement();return Object.entries({margin:"0px",top:"0px",left:"0px",position:"absolute"}).forEach(([n,r])=>e.style.setProperty(n,r)),e}onViewportChange(e){this.viewport=e,this.updateHTML()}onHover(e){if(this.props.mode==="hover"&&this.props.getTooltip){let i=this.props.getTooltip(e,this);this.setProps({visible:i!==null,...i,style:{zIndex:"1",...i?.style}})}}onClick(e){if(this.props.mode==="click"&&this.props.getTooltip){let i=this.props.getTooltip(e,this);return this.setProps({visible:i!==null,...i}),i!==null}return this.props.onClick?.(this,e)||!1}onAdd({deck:e,viewId:i}){this.deck=e,i?this.viewport=e.getViewports().find(n=>n.id===i):this.viewport=e.getViewports()[0]}onRenderHTML(e){if(!this.viewport)return;let[i,n]=this.props.position,[r,d]=this.viewport.project([i,n]),a=this.props.minOffset||0,p=10,c=8,u=16,s=d>this.viewport.height/2,h=this.props.style&&this.props.style.background||"rgba(255,255,255,0.9)",m=this.props.visible?l("div",{className:"popup-container",style:{position:"absolute",left:0,top:0},children:[l("div",{className:"popup-content",style:{background:h,padding:"10px",position:"relative",...this.props.style},children:this.props.text}),l("div",{className:"popup-arrow",style:{position:"absolute",width:"0px",height:"0px"}})]}):null;f(m,e),requestAnimationFrame(()=>{if(!this.props.visible||!e.firstChild||!this.viewport)return;let _=e.firstChild,I=_.querySelector(".popup-content"),g=_.querySelector(".popup-arrow");if(!I||!g)return;let v=I.getBoundingClientRect(),w=v.width,H=v.height,T=r-w/2,W;s?W=d-p-c-H:W=d+p+c,T<a&&(T=a),T+w>this.viewport.width-a&&(T=this.viewport.width-a-w),s?W<a&&(W=a):W+H+c>this.viewport.height-a&&(W=this.viewport.height-a-H-c),_.style.left=`${T}px`,_.style.top=`${W}px`,_.style.transform="";let S=r-T-u/2;S=Math.max(S,0),S=Math.min(S,w-u),s?(g.style.left=`${S}px`,g.style.bottom=`-${c}px`,g.style.top="",g.style.borderLeft=`${u/2}px solid transparent`,g.style.borderRight=`${u/2}px solid transparent`,g.style.borderTop=`${c}px solid ${h}`,g.style.borderBottom=""):(g.style.left=`${S}px`,g.style.top=`-${c}px`,g.style.bottom="",g.style.borderLeft=`${u/2}px solid transparent`,g.style.borderRight=`${u/2}px solid transparent`,g.style.borderBottom=`${c}px solid ${h}`,g.style.borderTop="")})}};re.defaultProps={...it.Widget.defaultProps,id:"info",position:[0,0],text:"",visible:!1,minOffset:0,viewId:null,mode:"hover",getTooltip:void 0,onClick:void 0};var nt=y(x(),1);var Vo={position:"absolute",top:"100%",left:0,background:"white",border:"1px solid #ccc",borderRadius:"4px",marginTop:"var(--menu-gap, 4px)",zIndex:100},Ro={background:"white",border:"none",padding:"4px",cursor:"pointer",pointerEvents:"auto"},Ve=t=>{let{menuItems:o,onItemSelected:e,position:i,style:n}=t,r={...Vo,...n,left:`${i.x}px`,top:`${i.y}px`};return l("div",{style:r,children:o.map(({key:d,label:a})=>l("button",{style:{...Ro,display:"block"},onClick:p=>e(d),children:a},d))})};var No=2,Go=3,se=class extends nt.Widget{constructor(e){super(e);this.className="deck-widget-context-menu";this.placement="fill";this.pickInfo=null;this.pickInfo=null,this.setProps(this.props)}onAdd({deck:e}){let i=document.createElement("div");return i.classList.add("deck-widget","deck-widget-context-menu"),Object.entries({margin:"0px",top:"0px",left:"0px",position:"absolute",pointerEvents:"auto"}).forEach(([r,d])=>i.style.setProperty(r,d)),e.getCanvas()?.addEventListener("click",()=>this.hide()),e.getCanvas()?.addEventListener("contextmenu",r=>this.handleContextMenu(r)),i}onRenderHTML(e){let{visible:i,position:n,menuItems:r}=this.props,d=i&&r.length?l(Ve,{menuItems:r,onItemSelected:a=>this.props.onMenuItemSelected(a,this.pickInfo),position:n,style:{pointerEvents:"auto"}}):null;f(d,e)}handleContextMenu(e){if(e&&(e.button===No||e.which===Go)){this.pickInfo=this.deck?.pickObject({x:e.clientX,y:e.clientY})||null;let i=this.pickInfo&&this.props.getMenuItems?.(this.pickInfo,this)||[],n=i.length>0;return this.setProps({visible:n,position:{x:e.clientX,y:e.clientY},menuItems:i}),this.updateHTML(),e.preventDefault(),n}return!1}hide(){this.setProps({visible:!1})}};se.defaultProps={...nt.Widget.defaultProps,id:"context",viewId:null,visible:!1,position:{x:0,y:0},getMenuItems:void 0,menuItems:[],onMenuItemSelected:(e,i)=>console.log("Context menu item selected:",e,i)};var rt=y(x(),1);var ae=class extends rt.Widget{constructor(e={}){super(e);this.id="timeline";this.className="deck-widget-timeline";this.placement="bottom-left";this.playing=!1;this.timerId=null;this.handlePlayPause=()=>{this.playing?this.stop():this.start()};this.handleSliderChange=e=>{let i=e.target,n=Number(i.value);this.currentTime=n,this.props.onTimeChange(n),this.updateHTML()};this.tick=()=>{let[e,i]=this.props.timeRange,n=this.currentTime+this.props.step;n>i&&(n=e),this.currentTime=n,this.props.onTimeChange(n),this.updateHTML(),this.playing&&(this.timerId=window.setTimeout(this.tick,this.props.playInterval))};this.currentTime=this.props.initialTime??this.props.timeRange[0],this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onAdd(){this.playing=!1,this.timerId=null}onRemove(){this.stop()}onRenderHTML(e){f(l("div",{style:{display:"flex",alignItems:"center",pointerEvents:"auto"},children:[l(M,{label:this.playing?"Pause":"Play",onClick:this.handlePlayPause,children:l("div",{className:"text",children:this.playing?"\u23F8":"\u25B6"})}),l("input",{type:"range",className:"timeline-slider",min:this.props.timeRange[0],max:this.props.timeRange[1],step:this.props.step,value:this.currentTime,onInput:this.handleSliderChange})]}),e)}start(){this.playing=!0,this.updateHTML(),this.tick()}stop(){this.playing=!1,this.timerId!==null&&(window.clearTimeout(this.timerId),this.timerId=null),this.updateHTML()}};ae.defaultProps={...rt.Widget.defaultProps,id:"timeline",placement:"bottom-left",viewId:null,timeRange:[0,100],step:1,initialTime:void 0,onTimeChange:()=>{},playInterval:1e3};var st=y(x(),1);var le=class extends st.Widget{constructor(e={}){super(e);this.className="deck-widget-screenshot";this.placement="top-left";this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){f(l(M,{className:"deck-widget-camera",label:this.props.label,onClick:this.handleClick.bind(this)}),e)}handleClick(){if(this.props.onCapture){this.props.onCapture(this);return}let e=this.captureScreenToDataURL(this.props.imageFormat);e&&this.downloadDataURL(e,this.props.filename)}captureScreenToDataURL(e){return this.deck?.getCanvas()?.toDataURL(e)}downloadDataURL(e,i){let n=document.createElement("a");n.href=e,n.download=i,n.click()}};le.defaultProps={...st.Widget.defaultProps,id:"screenshot",placement:"top-left",viewId:null,label:"Screenshot",filename:"screenshot.png",imageFormat:"image/png",onCapture:void 0};var N=y(x(),1),at=y(x(),1);var Bt={"--widget-margin":"12px","--button-size":"28px","--button-corner-radius":"8px","--button-background":"#fff","--button-stroke":"rgba(255, 255, 255, 0.3)","--button-inner-stroke":"unset","--button-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25)","--button-backdrop-filter":"unset","--button-icon-idle":"rgba(97, 97, 102, 1)","--button-icon-hover":"rgba(24, 24, 26, 1)","--button-text":"rgb(24, 24, 26, 1)","--icon-compass-north-color":"rgb(240, 92, 68)","--icon-compass-south-color":"rgb(204, 204, 204)","--menu-gap":"4px","--menu-background":"#fff","--menu-backdrop-filter":"unset","--menu-border":"unset","--menu-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25)","--menu-text":"rgb(24, 24, 26, 1)","--menu-item-hover":"rgba(0, 0, 0, 0.08)"},zt={"--widget-margin":"12px","--button-size":"28px","--button-corner-radius":"8px","--button-background":"rgba(18, 18, 20, 1)","--button-stroke":"rgba(18, 18, 20, 0.30)","--button-inner-stroke":"unset","--button-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25)","--button-backdrop-filter":"unset","--button-icon-idle":"rgba(158, 157, 168, 1)","--button-icon-hover":"rgba(215, 214, 229, 1)","--button-text":"rgb(215, 214, 229, 1)","--icon-compass-north-color":"rgb(240, 92, 68)","--icon-compass-south-color":"rgb(200, 199, 209)","--menu-gap":"4px","--menu-background":"rgba(18, 18, 20, 1)","--menu-backdrop-filter":"unset","--menu-border":"unset","--menu-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25)","--menu-text":"rgb(215, 214, 229, 1)","--menu-item-hover":"rgba(255, 255, 255, 0.1)"},Re={"--widget-margin":"12px","--button-size":"28px","--button-corner-radius":"8px","--button-background":"rgba(255, 255, 255, 0.6)","--button-stroke":"rgba(255, 255, 255, 0.3)","--button-inner-stroke":"1px solid rgba(255, 255, 255, 0.6)","--button-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25), 0px 0px 8px 0px rgba(0, 0, 0, 0.1) inset","--button-backdrop-filter":"blur(4px)","--button-icon-idle":"rgba(97, 97, 102, 1)","--button-icon-hover":"rgba(24, 24, 26, 1)","--button-text":"rgb(24, 24, 26, 1)","--icon-compass-north-color":"rgb(240, 92, 68)","--icon-compass-south-color":"rgb(204, 204, 204)","--menu-gap":"4px","--menu-background":"rgba(255, 255, 255, 0.6)","--menu-backdrop-filter":"blur(4px)","--menu-border":"1px solid rgba(255, 255, 255, 0.6)","--menu-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25), 0px 0px 8px 0px rgba(0, 0, 0, 0.1) inset","--menu-text":"rgb(24, 24, 26, 1)","--menu-item-hover":"rgba(0, 0, 0, 0.08)"},Ne={"--widget-margin":"12px","--button-size":"28px","--button-corner-radius":"8px","--button-background":"rgba(18, 18, 20, 0.75)","--button-stroke":"rgba(18, 18, 20, 0.30)","--button-inner-stroke":"1px solid rgba(18, 18, 20, 0.75)","--button-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25), 0px 0px 8px 0px rgba(0, 0, 0, 0.1) inset","--button-backdrop-filter":"blur(4px)","--button-icon-idle":"rgba(158, 157, 168, 1)","--button-icon-hover":"rgba(215, 214, 229, 1)","--button-text":"rgb(215, 214, 229, 1)","--icon-compass-north-color":"rgb(240, 92, 68)","--icon-compass-south-color":"rgb(200, 199, 209)","--menu-gap":"4px","--menu-background":"rgba(18, 18, 20, 0.75)","--menu-backdrop-filter":"blur(4px)","--menu-border":"1px solid rgba(18, 18, 20, 0.75)","--menu-shadow":"0px 0px 8px 0px rgba(0, 0, 0, 0.25), 0px 0px 8px 0px rgba(0, 0, 0, 0.1) inset","--menu-text":"rgb(215, 214, 229, 1)","--menu-item-hover":"rgba(255, 255, 255, 0.1)"};var de=class extends at.Widget{constructor(e={}){super(e);this.className="deck-widget-theme";this.placement="top-left";this.themeMode="dark";this.themeMode=this._getInitialThemeMode(),this.setProps(this.props)}setProps(e){let{lightModeTheme:i,darkModeTheme:n}=this.props;switch(this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e),this.themeMode){case"light":e.lightModeTheme&&!(0,N._deepEqual)(e.lightModeTheme,i,1)&&this._setThemeMode("light");break;case"dark":e.darkModeTheme&&!(0,N._deepEqual)(e.darkModeTheme,n,1)&&this._setThemeMode("dark");break;default:N.log.warn(`Invalid theme mode ${this.themeMode}`)()}}onRenderHTML(e){let{lightModeLabel:i,darkModeLabel:n}=this.props;f(l(M,{onClick:this._handleClick.bind(this),label:this.themeMode==="dark"?n:i,className:this.themeMode==="dark"?"deck-widget-moon":"deck-widget-sun"}),e)}onAdd(){this._setThemeMode(this.themeMode)}_handleClick(){let e=this.themeMode==="dark"?"light":"dark";this._setThemeMode(e)}_setThemeMode(e){this.themeMode=e;let i=this.rootElement?.closest(".deck-widget-container");if(i){let n=e==="dark"?this.props.darkModeTheme:this.props.lightModeTheme;(0,N._applyStyles)(i,n);let r=this.themeMode==="dark"?this.props.darkModeLabel:this.props.lightModeLabel;N.log.log(1,`Switched theme to ${r}`,n)(),this.updateHTML()}}_getInitialThemeMode(){let{initialThemeMode:e}=this.props;return e==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e}};de.defaultProps={...at.Widget.defaultProps,id:"theme",placement:"top-left",viewId:null,lightModeLabel:"Light Mode",lightModeTheme:Re,darkModeLabel:"Dark Mode",darkModeTheme:Ne,initialThemeMode:"auto"};var lt=y(x(),1);var ce=class extends lt.Widget{constructor(e={}){super(e);this.className="deck-widget-loading";this.placement="top-left";this.loading=!0;this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onRenderHTML(e){f(this.loading&&l(M,{className:"deck-widget-spinner",label:this.props.label,onClick:this.handleClick.bind(this)}),e)}onRedraw({layers:e}){let i=e.some(n=>!n.isLoaded);i!==this.loading&&(this.loading=i,this.updateHTML())}handleClick(){}};ce.defaultProps={...lt.Widget.defaultProps,id:"loading",placement:"top-left",viewId:null,label:"Loading layer data"};var dt=y(x(),1);var pe=class extends dt.Widget{constructor(e={}){super(e);this.className="deck-widget-fps";this.placement="top-left";this._lastFps=-1;this.setProps(this.props)}setProps(e){this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,super.setProps(e)}onAdd({}){this._lastFps=this._getFps(),requestAnimationFrame(()=>this._animate())}onRenderHTML(e){let i=this._getFps();f(l(M,{children:l("div",{className:"text",children:["FPS",l("br",{}),i]})}),e)}_animate(){let e=this._getFps();this._lastFps!==e&&(this._lastFps=e,this.updateHTML()),requestAnimationFrame(()=>this._animate())}_getFps(){return Math.round(this.deck?.metrics.fps??0)}};pe.defaultProps={...dt.Widget.defaultProps,id:"fps",placement:"top-left",viewId:null};var ct=y(x(),1),Zt=y(Jt(),1);var Do="\u25B6",Oo="\u2B07",pt=t=>`${t.name}: ${t.count}`;function ut(t){return t<1e3?`${t.toFixed(2)}ms`:`${(t/1e3).toFixed(2)}s`}function Yt(t){return`${(t/1e6).toFixed(1)} MB`}var Kt={count:pt,averageTime:t=>`${t.name}: ${ut(t.getAverageTime())}`,totalTime:t=>`${t.name}: ${ut(t.time)}`,fps:t=>`${t.name}: ${Math.round(t.getHz())}fps`,memory:t=>`${t.name}: ${Yt(t.count)}`},ue=class extends ct.Widget{constructor(e={}){super(e);this.className="deck-widget-stats";this.placement="top-left";this._counter=0;this.collapsed=!0;this._toggleCollapsed=()=>{this.collapsed=!this.collapsed,this.updateHTML()};this._formatters={...Kt},this._resetOnUpdate={...this.props.resetOnUpdate},this.setProps(e)}setProps(e){if(this.placement=e.placement??this.placement,this.viewId=e.viewId??this.viewId,e.formatters)for(let i in e.formatters){let n=e.formatters[i];this._formatters[i]=typeof n=="string"?Kt[n]||pt:n}e.resetOnUpdate&&(this._resetOnUpdate={...e.resetOnUpdate}),super.setProps(e)}onAdd(){this.updateHTML()}onRenderHTML(e){let i=this._getStats(),n=this.collapsed,r=this.props.title||("id"in i?i.id:null)||"Stats",d=[];!n&&i&&i.forEach(a=>{let p=this._getLines(a).split(`
`);this._resetOnUpdate&&this._resetOnUpdate[a.name]&&a.reset(),p.forEach((c,u)=>{d.push(l("div",{style:{whiteSpace:"pre"},children:c},`${a.name}-${u}`))})}),f(l("div",{className:"deck-widget-stats-container",style:{cursor:"default"},children:[l("div",{className:"deck-widget-stats-header",style:{cursor:"pointer",pointerEvents:"auto"},onClick:this._toggleCollapsed,children:[n?Do:Oo," ",r]}),!n&&l("div",{className:"deck-widget-stats-content",children:d})]}),e)}onRedraw(){let e=Math.max(1,this.props.framesPerUpdate||1);this._counter++%e===0&&this.updateHTML()}_getStats(){switch(this.props.type){case"deck":let e=this.deck?.metrics??{};return Object.entries(e);case"luma":return Array.from(Zt.luma.stats.stats.values())[0];case"device":let n=this.deck?.device?.statsManager.stats.values();return n?Array.from(n)[0]:[];case"custom":return this.props.stats;default:throw new Error(`Unknown stats type: ${this.props.type}`)}}_getLines(e){if("count"in e)return(this._formatters[e.name]||this._formatters[e.type||""]||pt)(e);let[i,n]=e,r=i.endsWith("Memory")?Yt(n):i.includes("Time")?ut(n):`${n.toFixed(2)}`;return`${i}: ${r}`}};ue.defaultProps={...ct.Widget.defaultProps,type:"deck",placement:"top-left",viewId:null,stats:void 0,title:"Stats",framesPerUpdate:1,formatters:{},resetOnUpdate:{},id:"stats"};return no(me);})();
      return __exports__;
      });
